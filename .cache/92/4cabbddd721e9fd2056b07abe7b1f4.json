{"id":"hkMV","dependencies":[{"name":"/home/i6apxat/htdocs/ol6/package.json","includedInParent":true,"mtime":1679700623179},{"name":"/home/i6apxat/htdocs/ol6/node_modules/ol/package.json","includedInParent":true,"mtime":1679700665093},{"name":"./Layer.js","loc":{"line":19,"column":32,"index":843},"parent":"/home/i6apxat/htdocs/ol6/node_modules/ol/renderer/canvas/TileLayer.js","resolved":"/home/i6apxat/htdocs/ol6/node_modules/ol/renderer/canvas/Layer.js"},{"name":"../../ImageTile.js","loc":{"line":20,"column":22,"index":879},"parent":"/home/i6apxat/htdocs/ol6/node_modules/ol/renderer/canvas/TileLayer.js","resolved":"/home/i6apxat/htdocs/ol6/node_modules/ol/ImageTile.js"},{"name":"../../reproj/Tile.js","loc":{"line":21,"column":23,"index":924},"parent":"/home/i6apxat/htdocs/ol6/node_modules/ol/renderer/canvas/TileLayer.js","resolved":"/home/i6apxat/htdocs/ol6/node_modules/ol/reproj/Tile.js"},{"name":"../../TileRange.js","loc":{"line":22,"column":22,"index":970},"parent":"/home/i6apxat/htdocs/ol6/node_modules/ol/renderer/canvas/TileLayer.js","resolved":"/home/i6apxat/htdocs/ol6/node_modules/ol/TileRange.js"},{"name":"../../TileState.js","loc":{"line":23,"column":22,"index":1014},"parent":"/home/i6apxat/htdocs/ol6/node_modules/ol/renderer/canvas/TileLayer.js","resolved":"/home/i6apxat/htdocs/ol6/node_modules/ol/TileState.js"},{"name":"./common.js","loc":{"line":24,"column":66,"index":1102},"parent":"/home/i6apxat/htdocs/ol6/node_modules/ol/renderer/canvas/TileLayer.js","resolved":"/home/i6apxat/htdocs/ol6/node_modules/ol/renderer/canvas/common.js"},{"name":"../../transform.js","loc":{"line":25,"column":114,"index":1231},"parent":"/home/i6apxat/htdocs/ol6/node_modules/ol/renderer/canvas/TileLayer.js","resolved":"/home/i6apxat/htdocs/ol6/node_modules/ol/transform.js"},{"name":"../../obj.js","loc":{"line":26,"column":23,"index":1276},"parent":"/home/i6apxat/htdocs/ol6/node_modules/ol/renderer/canvas/TileLayer.js","resolved":"/home/i6apxat/htdocs/ol6/node_modules/ol/obj.js"},{"name":"../../extent.js","loc":{"line":27,"column":139,"index":1431},"parent":"/home/i6apxat/htdocs/ol6/node_modules/ol/renderer/canvas/TileLayer.js","resolved":"/home/i6apxat/htdocs/ol6/node_modules/ol/extent.js"},{"name":"../../proj.js","loc":{"line":28,"column":31,"index":1481},"parent":"/home/i6apxat/htdocs/ol6/node_modules/ol/renderer/canvas/TileLayer.js","resolved":"/home/i6apxat/htdocs/ol6/node_modules/ol/proj.js"},{"name":"../../util.js","loc":{"line":29,"column":23,"index":1521},"parent":"/home/i6apxat/htdocs/ol6/node_modules/ol/renderer/canvas/TileLayer.js","resolved":"/home/i6apxat/htdocs/ol6/node_modules/ol/util.js"},{"name":"../../array.js","loc":{"line":30,"column":42,"index":1580},"parent":"/home/i6apxat/htdocs/ol6/node_modules/ol/renderer/canvas/TileLayer.js","resolved":"/home/i6apxat/htdocs/ol6/node_modules/ol/array.js"},{"name":"../../size.js","loc":{"line":31,"column":23,"index":1621},"parent":"/home/i6apxat/htdocs/ol6/node_modules/ol/renderer/canvas/TileLayer.js","resolved":"/home/i6apxat/htdocs/ol6/node_modules/ol/size.js"}],"generated":{"js":"var $hkMV$exports={};$parcel$require(\"hkMV\",\"./Layer.js\"),$parcel$require(\"hkMV\",\"../../ImageTile.js\"),$parcel$require(\"hkMV\",\"../../reproj/Tile.js\"),$parcel$require(\"hkMV\",\"../../TileRange.js\"),$parcel$require(\"hkMV\",\"../../TileState.js\"),$parcel$require(\"hkMV\",\"./common.js\"),$parcel$require(\"hkMV\",\"../../transform.js\"),$parcel$require(\"hkMV\",\"../../obj.js\"),$parcel$require(\"hkMV\",\"../../extent.js\"),$parcel$require(\"hkMV\",\"../../proj.js\"),$parcel$require(\"hkMV\",\"../../util.js\"),$parcel$require(\"hkMV\",\"../../array.js\"),$parcel$require(\"hkMV\",\"../../size.js\");var $hkMV$var$__extends=$hkMV$exports&&$hkMV$exports.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if(\"function\"!=typeof r&&null!==r)throw new TypeError(\"Class extends value \"+String(r)+\" is not a constructor or null\");function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),$hkMV$export$default=function(e){function t(t){var r=e.call(this,t)||this;return r.extentChanged=!0,r.renderedExtent_=null,r.renderedPixelRatio,r.renderedProjection=null,r.renderedRevision,r.renderedTiles=[],r.newTiles_=!1,r.tmpExtent=$hkMV$import$createEmpty(),r.tmpTileRange_=new $hkMV$import$TileRange(0,0,0,0),r}return $hkMV$var$__extends(t,e),t.prototype.isDrawableTile=function(e){var t=this.getLayer(),r=e.getState(),i=t.getUseInterimTilesOnError();return r==$hkMV$import$TileState.LOADED||r==$hkMV$import$TileState.EMPTY||r==$hkMV$import$TileState.ERROR&&!i},t.prototype.getTile=function(e,t,r,i){var o=i.pixelRatio,n=i.viewState.projection,a=this.getLayer(),s=a.getSource().getTile(e,t,r,o,n);return s.getState()==$hkMV$import$TileState.ERROR&&(a.getUseInterimTilesOnError()?a.getPreload()>0&&(this.newTiles_=!0):s.setState($hkMV$import$TileState.LOADED)),this.isDrawableTile(s)||(s=s.getInterimTile()),s},t.prototype.getData=function(e){var t=this.frameState;if(!t)return null;var r=this.getLayer(),i=$hkMV$import$applyTransform(t.pixelToCoordinateTransform,e.slice()),o=r.getExtent();if(o&&!$hkMV$import$containsCoordinate(o,i))return null;for(var n=t.pixelRatio,a=t.viewState.projection,s=t.viewState,l=r.getRenderSource(),h=l.getTileGridForProjection(s.projection),$=l.getTilePixelRatio(t.pixelRatio),p=h.getZForResolution(s.resolution);p>=h.getMinZoom();--p){var d=h.getTileCoordForCoordAndZ(i,p),u=l.getTile(p,d[1],d[2],n,a);if(!(u instanceof $hkMV$import$ImageTile||u instanceof $hkMV$import$ReprojTile))return null;if(u.getState()===$hkMV$import$TileState.LOADED){var c=h.getOrigin(p),g=$hkMV$import$toSize(h.getTileSize(p)),m=h.getResolution(p),T=Math.floor($*((i[0]-c[0])/m-d[1]*g[0])),f=Math.floor($*((c[1]-i[1])/m-d[2]*g[1])),M=Math.round($*l.getGutterForProjection(s.projection));return this.getImageData(u.getImage(),T+M,f+M)}}return null},t.prototype.loadedTileCallback=function(t,r,i){return!!this.isDrawableTile(i)&&e.prototype.loadedTileCallback.call(this,t,r,i)},t.prototype.prepareFrame=function(e){return!!this.getLayer().getSource()},t.prototype.renderFrame=function(e,t){var r=e.layerStatesArray[e.layerIndex],i=e.viewState,o=i.projection,n=i.resolution,a=i.center,s=i.rotation,l=e.pixelRatio,h=this.getLayer(),$=h.getSource(),p=$.getRevision(),d=$.getTileGridForProjection(o),u=d.getZForResolution(n,$.zDirection),c=d.getResolution(u),g=e.extent,m=e.viewState.resolution,T=$.getTilePixelRatio(l),f=Math.round($hkMV$import$getWidth(g)/m*l),M=Math.round($hkMV$import$getHeight(g)/m*l),k=r.extent&&$hkMV$import$fromUserExtent(r.extent,o);k&&(g=$hkMV$import$getIntersection(g,$hkMV$import$fromUserExtent(r.extent,o)));var v=c*f/2/T,V=c*M/2/T,x=[a[0]-v,a[1]-V,a[0]+v,a[1]+V],y=d.getTileRangeForExtentAndZ(g,u),R={};R[u]={};var S=this.createLoadedTileFinder($,o,R),w=this.tmpExtent,j=this.tmpTileRange_;this.newTiles_=!1;for(var E=s?$hkMV$import$getRotatedViewport(i.center,m,s,e.size):void 0,C=y.minX;C<=y.maxX;++C)for(var _=y.minY;_<=y.maxY;++_)if(!s||d.tileCoordIntersectsViewport([u,C,_],E)){var I=this.getTile(u,C,_,e);if(this.isDrawableTile(I)){var O=$hkMV$import$getUid(this);if(I.getState()==$hkMV$import$TileState.LOADED)R[u][I.tileCoord.toString()]=I,(re=I.inTransition(O))&&1!==r.opacity&&(I.endTransition(O),re=!1),this.newTiles_||!re&&-1!==this.renderedTiles.indexOf(I)||(this.newTiles_=!0);if(1===I.getAlpha(O,e.time))continue}var P=d.getTileCoordChildTileRange(I.tileCoord,j,w),A=!1;P&&(A=S(u+1,P)),A||d.forEachTileCoordParentTileRange(I.tileCoord,S,j,w)}var D=c/n*l/T;$hkMV$import$composeTransform(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/l,1/l,s,-f/2,-M/2);var b=$hkMV$import$toTransformString(this.pixelTransform);this.useContainer(t,b,this.getBackground(e));var q=this.context,L=q.canvas;$hkMV$import$makeInverse(this.inversePixelTransform,this.pixelTransform),$hkMV$import$composeTransform(this.tempTransform,f/2,M/2,D,D,0,-f/2,-M/2),L.width!=f||L.height!=M?(L.width=f,L.height=M):this.containerReused||q.clearRect(0,0,f,M),k&&this.clipUnrotated(q,e,k),$.getInterpolate()||$hkMV$import$assign(q,$hkMV$import$IMAGE_SMOOTHING_DISABLED),this.preRender(q,e),this.renderedTiles.length=0;var F,U,z,G=Object.keys(R).map(Number);G.sort($hkMV$import$numberSafeCompareFunction),1!==r.opacity||this.containerReused&&!$.getOpaque(e.viewState.projection)?(F=[],U=[]):G=G.reverse();for(var Z=G.length-1;Z>=0;--Z){var Y=G[Z],K=$.getTilePixelSize(Y,l,o),N=d.getResolution(Y)/c,X=K[0]*N*D,B=K[1]*N*D,H=d.getTileCoordForCoordAndZ($hkMV$import$getTopLeft(x),Y),Q=d.getTileCoordExtent(H),W=$hkMV$import$applyTransform(this.tempTransform,[T*(Q[0]-x[0])/c,T*(x[3]-Q[3])/c]),J=T*$.getGutterForProjection(o),ee=R[Y];for(var te in ee){var re,ie=(I=ee[te]).tileCoord,oe=H[1]-ie[1],ne=Math.round(W[0]-(oe-1)*X),ae=H[2]-ie[2],se=Math.round(W[1]-(ae-1)*B),le=ne-(C=Math.round(W[0]-oe*X)),he=se-(_=Math.round(W[1]-ae*B)),$e=u===Y,pe=!1;if(!(re=$e&&1!==I.getAlpha($hkMV$import$getUid(this),e.time)))if(F){z=[C,_,C+le,_,C+le,_+he,C,_+he];for(var de=0,ue=F.length;de<ue;++de)if(u!==Y&&Y<U[de]){var ce=F[de];$hkMV$import$intersects([C,_,C+le,_+he],[ce[0],ce[3],ce[4],ce[7]])&&(pe||(q.save(),pe=!0),q.beginPath(),q.moveTo(z[0],z[1]),q.lineTo(z[2],z[3]),q.lineTo(z[4],z[5]),q.lineTo(z[6],z[7]),q.moveTo(ce[6],ce[7]),q.lineTo(ce[4],ce[5]),q.lineTo(ce[2],ce[3]),q.lineTo(ce[0],ce[1]),q.clip())}F.push(z),U.push(Y)}else q.clearRect(C,_,le,he);this.drawTileImage(I,e,C,_,le,he,J,$e),F&&!re?(pe&&q.restore(),this.renderedTiles.unshift(I)):this.renderedTiles.push(I),this.updateUsedTiles(e.usedTiles,$,I)}}return this.renderedRevision=p,this.renderedResolution=c,this.extentChanged=!this.renderedExtent_||!$hkMV$import$equals(this.renderedExtent_,x),this.renderedExtent_=x,this.renderedPixelRatio=l,this.renderedProjection=o,this.manageTilePyramid(e,$,d,l,o,g,u,h.getPreload()),this.scheduleExpireCache(e,$),this.postRender(q,e),r.extent&&q.restore(),$hkMV$import$assign(q,$hkMV$import$IMAGE_SMOOTHING_ENABLED),b!==L.style.transform&&(L.style.transform=b),this.container},t.prototype.drawTileImage=function(e,t,r,i,o,n,a,s){var l=this.getTileImage(e);if(l){var h=$hkMV$import$getUid(this),$=t.layerStatesArray[t.layerIndex],p=$.opacity*(s?e.getAlpha(h,t.time):1),d=p!==this.context.globalAlpha;d&&(this.context.save(),this.context.globalAlpha=p),this.context.drawImage(l,a,a,l.width-2*a,l.height-2*a,r,i,o,n),d&&this.context.restore(),p!==$.opacity?t.animate=!0:s&&e.endTransition(h)}},t.prototype.getImage=function(){var e=this.context;return e?e.canvas:null},t.prototype.getTileImage=function(e){return e.getImage()},t.prototype.scheduleExpireCache=function(e,t){if(t.canExpireCache()){var r=function(e,t,r){var i=$hkMV$import$getUid(e);i in r.usedTiles&&e.expireCache(r.viewState.projection,r.usedTiles[i])}.bind(null,t);e.postRenderFunctions.push(r)}},t.prototype.updateUsedTiles=function(e,t,r){var i=$hkMV$import$getUid(t);i in e||(e[i]={}),e[i][r.getKey()]=!0},t.prototype.manageTilePyramid=function(e,t,r,i,o,n,a,s,l){var h=$hkMV$import$getUid(t);h in e.wantedTiles||(e.wantedTiles[h]={});var $,p,d,u,c,g,m=e.wantedTiles[h],T=e.tileQueue,f=r.getMinZoom(),M=e.viewState.rotation,k=M?$hkMV$import$getRotatedViewport(e.viewState.center,e.viewState.resolution,M,e.size):void 0,v=0;for(g=f;g<=a;++g)for(p=r.getTileRangeForExtentAndZ(n,g,p),d=r.getResolution(g),u=p.minX;u<=p.maxX;++u)for(c=p.minY;c<=p.maxY;++c)M&&!r.tileCoordIntersectsViewport([g,u,c],k)||(a-g<=s?(++v,($=t.getTile(g,u,c,i,o)).getState()==$hkMV$import$TileState.IDLE&&(m[$.getKey()]=!0,T.isKeyQueued($.getKey())||T.enqueue([$,h,r.getTileCoordCenter($.tileCoord),d])),void 0!==l&&l($)):t.useTile(g,u,c,o));t.updateCacheSize(v,o)},t}($hkMV$import$CanvasLayerRenderer);$hkMV$exports.default=$hkMV$export$default;"},"sourceMaps":null,"error":null,"hash":"b893b16d331f57e290745a6e48d3039e","cacheData":{"env":{},"imports":{"$hkMV$import$CanvasLayerRenderer":["./Layer.js","default"],"$hkMV$import$ImageTile":["../../ImageTile.js","default"],"$hkMV$import$ReprojTile":["../../reproj/Tile.js","default"],"$hkMV$import$TileRange":["../../TileRange.js","default"],"$hkMV$import$TileState":["../../TileState.js","default"],"$hkMV$import$IMAGE_SMOOTHING_DISABLED":["./common.js","IMAGE_SMOOTHING_DISABLED"],"$hkMV$import$IMAGE_SMOOTHING_ENABLED":["./common.js","IMAGE_SMOOTHING_ENABLED"],"$hkMV$import$applyTransform":["../../transform.js","apply"],"$hkMV$import$composeTransform":["../../transform.js","compose"],"$hkMV$import$makeInverse":["../../transform.js","makeInverse"],"$hkMV$import$toTransformString":["../../transform.js","toString"],"$hkMV$import$assign":["../../obj.js","assign"],"$hkMV$import$containsCoordinate":["../../extent.js","containsCoordinate"],"$hkMV$import$createEmpty":["../../extent.js","createEmpty"],"$hkMV$import$equals":["../../extent.js","equals"],"$hkMV$import$getHeight":["../../extent.js","getHeight"],"$hkMV$import$getIntersection":["../../extent.js","getIntersection"],"$hkMV$import$getRotatedViewport":["../../extent.js","getRotatedViewport"],"$hkMV$import$getTopLeft":["../../extent.js","getTopLeft"],"$hkMV$import$getWidth":["../../extent.js","getWidth"],"$hkMV$import$intersects":["../../extent.js","intersects"],"$hkMV$import$fromUserExtent":["../../proj.js","fromUserExtent"],"$hkMV$import$getUid":["../../util.js","getUid"],"$hkMV$import$numberSafeCompareFunction":["../../array.js","numberSafeCompareFunction"],"$hkMV$import$toSize":["../../size.js","toSize"]},"exports":{"default":"$hkMV$export$default"},"wildcards":[],"sideEffects":false,"isCommonJS":true,"isES6Module":true}}